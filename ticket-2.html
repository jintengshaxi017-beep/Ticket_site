<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>仲直り券</title>
<link rel="stylesheet" href="style.css">
</head>

<body>
    <h1>仲直り券</h1>
    <img src="make_up.png" style="width: 300px; display: block; margin: 0 auto;">
    <p>ピンチな時に仲直りができる券です</p>
    <p>※1か月に6回利用できます</p>
    <button id="useBtn">使用する</button>

    <script>
    document.addEventListener("DOMContentLoaded", function(){
        const ticketName="仲直り券";
        const cooldown=1000*60*60;
        const lastUsed=Number(localStorage.getItem(ticketName));
        const now=Date.now();

        const btn=document.getElementById("useBtn");
        
        if (lastUsed && now - lastUsed < cooldown) {
            btn.disabled = true;
            const availableAt = new Date(lastUsed + cooldown);
            const formatted = availableAt.toLocaleString("ja-JP");
            btn.innerText = `使用不可（${formatted}以降）`;
        }

        btn.onclick=function(){
            localStorage.setItem(ticketName, Date.now());
            window.location.href="used.html?ticket=" + encodeURIComponent(ticketName);
        };
    });
    </script>
</body>

</html>









